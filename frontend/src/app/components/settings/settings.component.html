<div class="step">
  <h2>Configuration</h2>
  <div class="error" *ngIf="error">{{ error }}</div>

  <fieldset>
    <legend>Dossiers</legend>
    <label class="dir-row">
      <span>Source :</span>
      <input type="text" [(ngModel)]="config.source" readonly/>
      <button (click)="selectSource()" [disabled]="loadingSource">
        {{ loadingSource ? '…' : 'Sélectionner' }}
      </button>
    </label>

    <label class="dir-row">
      <span>Destination :</span>
      <input type="text" [(ngModel)]="config.destination" readonly/>
      <button (click)="selectDestination()" [disabled]="loadingDest">
        {{ loadingDest ? '…' : 'Sélectionner' }}
      </button>
    </label>

    <label>
      <input type="checkbox" [(ngModel)]="config.create_subfolder"/>
      Créer un sous-dossier
    </label>
    <div *ngIf="config.create_subfolder" class="subfolder-options">
      <label>
        Nom du dossier :
        <input type="text" [(ngModel)]="config.folder_name" placeholder="(facultatif)"/>
      </label>
      <label>
        <input type="checkbox" [(ngModel)]="config.use_timestamp"/>
        Utiliser la date
      </label>
    </div>
  </fieldset>

  <fieldset>
    <legend>Paires de remplacement</legend>
    <div class="pair-controls">
      <button (click)="addPair()">+ Ajouter une paire</button>
      <button (click)="addFuseRobberPairs()">Ajouter paires Fuse→Robber</button>
      <button (click)="generatePairsVariants()">Générer variantes</button>
    </div>
    <div *ngFor="let wp of config.pairs; let i = index" class="pair-row">
      <input [(ngModel)]="wp.old" placeholder="À remplacer"/>
      →
      <input [(ngModel)]="wp.new" placeholder="Par"/>
      <button (click)="removePair(i)">✕</button>
    </div>
  </fieldset>

  <fieldset>
    <legend>Options avancées</legend>
    <label>
      <input type="checkbox" [(ngModel)]="config.variants"/>
      Générer automatiquement variantes de casse (lower/UPPER)
    </label>
    <label>
      <input type="checkbox" [(ngModel)]="config.rename"/>
      Renommer fichiers et dossiers
    </label>
  </fieldset>

  <div class="buttons">
    <button (click)="prev()">← Précédent</button>
    <button [disabled]="!canProceed()" (click)="next()">Suivant →</button>
  </div>
</div>
